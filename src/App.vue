<script setup>
import {ref} from 'vue'
import Level from './Level.vue'
import Winstreak from './Winstreak.vue';
import AnswerOptions from './AnswerOptions.vue';
import Layout from './Layout.vue';
import Emoji from './Emoji.vue'

const films = ref([
  {id: 0, film_file_path: '...', difficult_id: 1, name: 'Ğ¢Ğ¸Ñ‚Ğ°Ğ½Ğ¸Ğº', emojies: 'ğŸš¢ğŸ§ŠğŸ’”'},
  {id: 1, film_file_path: '...', difficult_id: 1, name: 'Ğ“Ğ°Ñ€Ñ€Ğ¸ ĞŸĞ¾Ğ´Ñ‚Ñ‘Ñ€', emojies: 'ğŸ§™â€â™‚ï¸âš¡ï¸ğŸ‘“'},
  {id: 2, film_file_path: '...', difficult_id: 1, name: 'ĞŸÑ€Ğ¸Ğ½Ñ†ĞµÑÑĞ° Ğ¸ Ğ»ÑĞ³ÑƒÑˆĞºĞ°', emojies: 'ğŸ‘¸ğŸ¸ğŸ’‹'},
  {id: 3, film_file_path: '...', difficult_id: 2, name: 'ĞĞ´ĞµÑ€Ğ¶Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ', emojies: 'ğŸ¥ğŸ”¥'},
  {id: 4, film_file_path: '...', difficult_id: 1, name: 'ĞšÑƒĞ½Ğ³-Ñ„Ñƒ Ğ¿Ğ°Ğ½Ğ´Ğ°', emojies: 'ğŸ¼ğŸ¥‹ğŸœ'},
  {id: 5, film_file_path: '...', difficult_id: 1, name: 'ĞĞ»Ğ»Ğ°Ğ´Ğ¸Ğ½', emojies: 'ğŸ§â€â™‚ï¸ğŸ”®ğŸŒ´'},
  {id: 6, film_file_path: '...', difficult_id: 1, name: 'Ğ Ğ°Ñ‚Ğ°Ñ‚ÑƒĞ¹', emojies: 'ğŸ€ğŸ‘¦ğŸ³'},
  {id: 7, film_file_path: '...', difficult_id: 1, name: 'Ğ’ Ğ¿Ğ¾Ğ¸ÑĞºĞ°Ñ… ĞĞµĞ¼Ğ¾', emojies: 'ğŸ ğŸŸğŸ”'},
  {id: 8, film_file_path: '...', difficult_id: 2, name: 'ĞĞ´Ğ¸Ğ½ Ğ´Ğ¾Ğ¼Ğ°', emojies: 'ğŸ‘¦ğŸ âœˆï¸'},
  {id: 9, film_file_path: '...', difficult_id: 3, name: 'Ğ¢Ñ€Ğ¾Ğµ Ğ² Ğ»Ğ¾Ğ´ĞºĞµ, Ğ½Ğµ ÑÑ‡Ğ¸Ñ‚Ğ°Ñ ÑĞ¾Ğ±Ğ°ĞºĞ¸', emojies: '3ï¸âƒ£ğŸš£ğŸ•'},
  {id: 10, film_file_path: '...', difficult_id: 1, name: 'ĞÑ…Ğ¾Ñ‚Ğ½Ğ¸ĞºĞ¸ Ğ·Ğ° Ğ¿Ñ€Ğ¸Ğ²Ğ¸Ğ´ĞµĞ½Ğ¸ÑĞ¼Ğ¸', emojies: 'ğŸ‘»ğŸš«'},
  {id: 11, film_file_path: '...', difficult_id: 1, name: 'ĞšÑ€ĞµĞ¿ĞºĞ¸Ğ¹ Ğ¾Ñ€ĞµÑˆĞµĞº', emojies: 'ğŸ’ªğŸ¥œ'},
  {id: 12, film_file_path: '...', difficult_id: 3, name: 'Ğ”Ğ¾ÑÑ‚ÑƒÑ‡Ğ°Ñ‚ÑŒÑÑ Ğ´Ğ¾ Ğ½ĞµĞ±ĞµÑ', emojies: 'ğŸ‘Šâ˜ï¸'},
  {id: 13, film_file_path: '...', difficult_id: 3, name: 'ĞœĞ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ğµ ÑĞ³Ğ½ÑÑ‚', emojies: 'ğŸ”‡ğŸ‘'},
  {id: 14, film_file_path: '...', difficult_id: 3, name: 'ĞŸĞ»Ğ°Ğ½ĞµÑ‚Ğ° Ğ¾Ğ±ĞµĞ·ÑŒÑĞ½', emojies: 'ğŸŒğŸ’'},
  {id: 15, film_file_path: '...', difficult_id: 3, name: 'Ğ’ Ğ´Ğ¶Ğ°Ğ·Ğµ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´ĞµĞ²ÑƒÑˆĞºĞ¸', emojies: 'ğŸºğŸ‘©â€â¤ï¸â€ğŸ‘©'},
  {id: 16, film_file_path: '...', difficult_id: 2, name: 'ĞŸĞ¸Ğ»Ğ°', emojies: 'ğŸªšâš°ï¸'},
  {id: 17, film_file_path: '...', difficult_id: 2, name: 'Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¸Ğ¹, Ğ¿Ğ»Ğ¾Ñ…Ğ¾Ğ¹, Ğ·Ğ»Ğ¾Ğ¹', emojies: 'ğŸ˜‡ğŸ˜ˆğŸ˜ '},
  {id: 18, film_file_path: '...', difficult_id: 2, name: 'Ğ­Ğ´Ğ²Ğ°Ñ€Ğ´ Ğ ÑƒĞºĞ¸-Ğ½Ğ¾Ğ¶Ğ½Ğ¸Ñ†Ñ‹', emojies: 'ğŸ‘¦ğŸ»ğŸ‘ğŸ»âœ‚ï¸'}
])

// const difficult = ref([
//   {id: 0, exp: 100, name: '...'}
// ])
// const levels = ref([
//   {id: 0, name: '...', difficult_id: 0, winstreak: 0}
// ])
// const users = ref([
//   {id: 0, avatar_path: '...', name: '..', exp: 100}
// ])

const rand = Math.floor(Math.random() * films.value.length)

//Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ² localstorage
const progress = ref({
  lvl: 0,
  winStreak: 0
})

// localStorage.setItem('progress', JSON.stringify(progress.value))
// const localProgress = JSON.parse(localStorage.getItem('progress'))


const correctFilm = ref(films.value[rand])
const emoji = ref(correctFilm.value.emojies)

function getRandomFilm() {
  const randomIndex = Math.floor(Math.random() * films.value.length)
  return films.value[randomIndex]
}

function createAnswerOptions() {
  const answerOptions = []


  while (answerOptions.length < 2) {
    const randomIndex = Math.floor(Math.random() * films.value.length)
    const wrongFilm = films.value[randomIndex]

    if (wrongFilm.name !== correctFilm.value.name && !answerOptions.includes(wrongFilm.name)) {
      answerOptions.push(wrongFilm.name)
    }
  }
  const randomIndexOptions = Math.floor(Math.random() * films.value.length)
  answerOptions.splice(randomIndexOptions, 0, correctFilm.value.name)

  return answerOptions
}

const answerOptions = ref(createAnswerOptions())

function changeFilm(answer) {
  if (answer === correctFilm.value.name) {
    progress.value.winStreak++
  } else {
    progress.value.winStreak = 0
  }
  correctFilm.value = getRandomFilm()
  emoji.value = correctFilm.value.emojies
  answerOptions.value = createAnswerOptions()
  console.log(progress.value.winStreak)

}


</script>

<template>
  <div class="container">
    <Layout
        class="component-card layout"
        :lvl="progress.lvl"
    >

    </Layout>

    <div class="stats-row">
      <Level
          class="component-card level"
          :lvl="progress.lvl"
      >

      </Level>

      <Winstreak
          class="component-card winstreak"
          :winStreak="progress.winStreak"
      >

      </Winstreak>
    </div>

    <Emoji
        class="component-card emoji-container"
        :emoji="emoji"
    />

    <AnswerOptions
        class="component-card answer-options"
        :answerOptions="answerOptions"
        @sendAnswer="changeFilm"

    >

    </AnswerOptions>

  </div>
</template>

<style>
* {
  padding: 0;
  margin: 0;
}

.container {
  min-height: 100vh;
  background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
  padding: 20px;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

/* ĞĞ±Ñ‰Ğ¸Ğ¹ ÑÑ‚Ğ¸Ğ»ÑŒ Ğ´Ğ»Ñ Ğ²ÑĞµÑ… ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ² */
.component-card {
  background: white;
  border-radius: 12px;
  padding: 20px;
  margin-bottom: 20px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  border: 1px solid #e1e5e9;
}

/* Ğ¡Ğ¿ĞµÑ†Ğ¸Ñ„Ğ¸Ñ‡Ğ½Ñ‹Ğµ ÑÑ‚Ğ¸Ğ»Ğ¸ Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ° */
.layout {
  background: linear-gradient(135deg, cadetblue 0%, #5f9ea0 100%);
  color: white;
  text-align: center;
}

.level {
  background: #68904D;
  color: white;
  font-weight: bold;
}

.winstreak {
  background: #EE9B01;
  color: white;
  font-weight: bold;
}

.emoji-container {
  text-align: center;
  font-size: 3rem;
  background: #f8f9fa;
  border: 2px dashed #68904D;
}

/* Ğ¡Ñ‚Ğ¸Ğ»Ğ¸ Ğ´Ğ»Ñ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ğ¾Ğ² Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ² */
.answer-options {
  background: white;
}

/* Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ Ğ´Ğ»Ñ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ñ…/Ğ½ĞµĞ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¾Ğ² */
.correct {
  border: 3px solid #68904D;
  background: #f0f9f0;
}

.incorrect {
  border: 3px solid #dc3545;
  background: #fdf2f2;
}

.feedback {
  text-align: center;
  padding: 10px;
  margin-top: 10px;
  border-radius: 6px;
  font-weight: bold;
}

.feedback.correct {
  color: #68904D;
  background: #f0f9f0;
}

.feedback.incorrect {
  color: #dc3545;
  background: #fdf2f2;
}
</style>

